<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Josh Rickard">
        <meta name="description" content="Lets Automate It">
        <meta name="keywords" content="blog,powershell,security,pwsh,python,active,directory,grouppolicy,windows,microsoft">
        <meta name="generator" content="Hugo 0.58.1" />
        <title> Josh Rickard | Lets Automate It</title>
        <meta name="description" content="Josh Rickard - Lets Automate It">
        <meta itemprop="name" content="Josh Rickard">
        <meta itemprop="description" content="Josh Rickard - Lets Automate It">
        <meta property="og:title" content="Josh Rickard">
        <meta property="og:description" content="Josh Rickard - Lets Automate It">
        <meta property="og:image" content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200">
        <meta property="og:url" content="https://letsautomate.it/author/josh-rickard/">
        <meta property="og:site_name" content="Lets Automate It"><meta property="og:type" content="website">
        <link rel="icon" type="image/png" href="https://letsautomate.it/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://letsautomate.it/favicon-16x16.png" sizes="16x16">

	
	  <link href="/author/josh-rickard/" rel="alternate" type="application/rss+xml" title="Lets Automate It" />
	  <link href="/author/josh-rickard/" rel="feed" type="application/rss+xml" title="Lets Automate It" />
	

        
        
        
        
        <link rel="stylesheet" href="/sass/combined.min.7f83b77967030d2b9718ae20e651f09824a213fef01829749559bbe9dfb82c4f.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav>

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="https://letsautomate.it/page/projects/">Projects</a></li>
                
            
                
                    <li><a href="https://letsautomate.it/page/presentations/">Presentations</a></li>
                
            
                
                    <li><a href="https://letsautomate.it/page/about/">About</a></li>
                
            
        </ul>

        
            <div id="search-box" class="search">
                <i class="fa fa-search"></i>
                <input id="search" type="text" placeholder="Search ...">
            </div>
        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="/images/default.jpg" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Lets Automate It</a></h3>
            
                <span class="subtitle">from Josh Rickard</span>
            
        </div>

    

        
        <div class="toggler">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
    
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://letsautomate.it/article/standardize-powershell-logging-with-my-write-logentry-function/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://letsautomate.it/article/standardize-powershell-logging-with-my-write-logentry-function/">Standardize Powershell Logging With My Write Logentry Function</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2018-08-07</span>
            
        

        

        

        
            <span class="author"><a href="/author/josh-rickard">Josh Rickard</a></span>
        
    </div>

    
        The PowerShell function Write-LogEntry described in this post allows you to integrate logging in your scripts in a standardized way. This will help you and your script users to troubleshoot and understand the output. Read More

        
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/archive">archive</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://letsautomate.it/article/design-before-coding-kanban/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://letsautomate.it/article/design-before-coding-kanban/">Design Before Coding Kanban</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2018-08-07</span>
            
        

        

        

        
            <span class="author"><a href="/author/josh-rickard">Josh Rickard</a></span>
        
    </div>

    
        <p>The first post in this three-part series focused on gathering requirements before spending time coding.  While it is not necessary, I recommend that everyone read part 1 (<a href="https://msadministrator.com/2017/03/29/design-before-coding-gathering-requirements/">Gathering Requirements</a>).  Understanding and having clear “User Stories” outlining the intended purpose of a tool is crucial, especially as we move towards building our new tool.</p>

<p>Once our “User Stories” have been defined and agreed upon by all stakeholders, we then need to begin breaking them down into tasks.  There are many different methodologies that allow us to track these different tasks. Part 2 of this three-part series will focus on one of them; Kanban.</p>

<p>I use Kanban daily, both personally and professionally.  If you want to understand the principles of Kanban, then I recommend that you start with <a href="https://en.wikipedia.org/wiki/Kanban">this</a> Wikipedia page. No matter what methodology or process you use, having a consistent and repeatable utility is a must.</p>

<p>This post will go over using Kanban both digitally and manually, but first you must understand the general purpose of Kanban.  Tracking our work can be difficult, especially with the use of E-mail, Slack, Skype, Teams, Yammer, HipChat, etc. etc.  The constant communication that is available to us is overwhelming, but having a central location that you can organize your “To-Do’s” or tasks is necessary.  Not for our management or organizations tracking purposes, it is so that we can track exactly what we need to do next.</p>

<p><img class="alignnone size-full wp-image-355" src="https://msadministrator.files.wordpress.com/2017/03/factory-35081_1280.png" alt="factory-35081_1280" width="1280" height="1006" /></p>

<p>The theory of Kanban is to visually identify items that need to be worked on. Kanban allows you to understand what tasks need to be worked on, which ones are in-progress, and which ones are complete.  Using this information, we begin to identify any blockers or obstacles that may need to be fixed so that an item/task can move from “To Do” to “Done”.  This principle helps us identify our WIP (Work in Progress) so that the flow between “gates” or “hand-off points” is as smooth and controlled as possible.  Think of this like an assembly line:
<p style="text-align:center;padding-left:60px;"><em>Let’s say we have two workers in an assembly line.  The first person’s job is to paint a car door handle, the second person’s job is to install that door handle on a new car.  If the first person can paint 5 handles in 10 minutes, but the second person takes 10 minutes to install the handle; we have a problem.  This means that we either need to increase staff that install car door handles or maybe the same person should do both.</em></p>
Understanding these blockers will help us identify gaps in our processes, or the lack of labor to accomplish our goals.  Visually displaying this information on a Kanban board is much easier to understand than a bunch of tasks lists or “tickets”.</p>

<p>There are many tools available for a digital Kanban board.  I have listed a few below that are both free and paid.  In my professional life, I use <a href="https://www.atlassian.com/software/jira">Jira’s</a> Kanban feature.  In my personal life, I use both a whiteboard with post-it notes and built-in features of GitHub Projects (<a href="https://github.com/MSAdministrator/GitHubCardsExample/projects/1">example</a>):
<ul>
    <li><a href="https://trello.com/">Trello</a></li>
    <li><a href="http://volerro.com/index.php">Vollero</a></li>
    <li><a href="http://kanbantool.com/free-kanban-board">Kanban Tool</a></li>
    <li><a href="http://www.kanbanchi.com/">Kanbanchi</a></li>
    <li><a href="https://taiga.io/">Taiga.io</a></li>
    <li><a href="https://clubhouse.io/">Clubhouse.io</a></li>
</ul>
If you just do a quick google search for “free Kanban tools” or go to <a href="http://github.com/">GitHub.com</a> and search for “<a href="https://github.com/search?utf8=%E2%9C%93&amp;q=kanban&amp;type=">Kanban</a>” you will find many open source projects that you can host yourself.  If you don’t want to host it yourself, then check out <a href="https://www.digitalocean.com/">DigitalOcean.com</a>.  If you think a digital tool would work for you, you can even use Outlook (<a href="https://github.com/frederik/outlook-task-kanban">here</a> or <a href="https://github.com/evrenvarol/outlook-taskboard">here</a>) or <a href="https://www.sortd.com/">Gmail</a> to manage your tasks in the Kanban style.</p>

<p>I’m not sure about you, but I personally carry a leather-bound notebook (with <a href="http://www.doanepaper.com/">DoanePaper</a>) with me wherever I go.  Whether at work, out with friends, going to bed, etc., I always have my notebook.  In my opinion a digital tool is great, but I’m faster at writing things down on paper than I am opening an app.  Plus, I always have it with me.</p>

<p><img class="alignnone size-full wp-image-361" src="https://msadministrator.files.wordpress.com/2017/03/simple-kanban-board.jpg" alt="Simple-kanban-board-" width="2355" height="1404" /></p>

<p>Another option or addition is by using a whiteboard in your home or work office.  The first thing you do is draw some columns.  Typically, you have three different columns: To-Do, In-Progress, and Done.  Starting out you will have everything in your To-Do column.  As you begin a new task you move that sticky-note to the In-Progress column.  If that item gets blocked or cannot be completed, you should move it back to the To-Do column.  You should only have a few items In-Progress (ideally, you would only have one).  Once you have completed that task, you move it to the Done column.</p>

<p>That’s it! Kanban allows you to visually see tasks and progress you are making on your projects.  The manual process is great for a single person or a team that is in close quarters.  If you’re spread out or in a cubicle this may not work as well.  This is where having a platform like Jira or Trello really shines.  Especially for teams that are global or in different locations.</p>

<p>Kanban is powerful, yet extremely simple. Using a tool to manage your tasks so that you understand exactly what you, your team, and others are working on reduces potential re-work while also making sure that all tasks for a project are complete (and on-time).  The third post in this series I will take the concepts of both post <a href="https://msadministrator.com/2017/03/29/design-before-coding-gathering-requirements/">one</a> and two, and we will begin to breakdown our User Stories onto our Kanban board.  Remember, we have not started coding yet.  Next, we will design how our stakeholders may use our new tool.  Understanding this, will speed up our development time and reduce re-work.</p>

    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/archive">archive</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://letsautomate.it/article/design-before-coding-gathering-requirements/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://letsautomate.it/article/design-before-coding-gathering-requirements/">Design Before Coding Gathering Requirements</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2018-08-07</span>
            
        

        

        

        
            <span class="author"><a href="/author/josh-rickard">Josh Rickard</a></span>
        
    </div>

    
        <p>If you have worked in IT for any duration, I’m sure you have overheard or been asked to build a tool to complete X or Y. Creating tools with PowerShell is fun, but it can become daunting when you create a tool that does not meet its intended purpose.  Without understanding the full requirements, you may waste time and energy on developing a tool that no one will use.</p>

<p>Creating tools with PowerShell to automate a manual process or to help an internal stakeholder accomplish a desired result, typically does not need to turn into a large initiative with a Project Manager or Project Management Office (PMO). Being tasked with creating these tools usually comes in the form a short conversation or through an email.  Out of habit, we usually dive right into writing a script or function to solve the problem.  This approach can cause a lot of re-work or redesign of our tool once complete.  Even though we believe we understand all the requirements, it is better to have the stakeholder create a “Goal Statement” that defines the intended purpose of the tool.  The “Goal Statement” helps everyone involved understand when the initiative is done.</p>

<p>A “Goal Statement” does not need to be a large body of work, it can simply be a couple of sentences or paragraphs.  Personally, I take the Scrum/Kanban approach and use User Stories.</p>

<p>User Stories are typically designed in the following format (there are different styles, but in my experience this the simplest form):
<p style="text-align:center;"><em>As a &lt;type of user&gt;, I want &lt;goal&gt; so that I &lt;receive benefit&gt;.</em></p>
Having a defined User Story reduces re-work and ensures that all stakeholders involved agree on the intended uses of this new tool.  Agreement on the intended results of this new initiative may not solve the problem completely, but it’s a great start!</p>

<p>At this point, we have not written any scripts, functions, modules, classes, etc.  You may want to dive right into writing a POC (Proof of Concept), but I recommend that you hold-off.  Once all stakeholders have agreed on our User Story, we should move to the design phase (Part 3 coming soon).</p>

<p>Let’s say that we work on a “Automation Team” in our organization that focuses on building tools to streamline processes for both IT and business teams.  We have been tasked with helping the organizations IT managers identify and verify that all Active Directory groups in our Forest have the correct owners associated with them.  As we start our requirements gathering phase, we ask all stakeholders to provide our team with agreed upon User Stories.  Our team receives the following:
<p style="padding-left:60px;"><em>As a manager, I want to know all Active Directory groups owned by myself so I can ensure that they are correct.</em><em> </em></p>
<p style="padding-left:60px;"><em>As a manager, I want to know all Active Directory groups owned by my employees so that I can ensure that they should have access.</em><em> </em></p>
<p style="padding-left:60px;"><em>As a manager, I want to know all Active Directory groups that do not have an owner but reside in my Active Directory OU so that I can assign the correct owner.</em></p>
Now that we have our agreed upon User Stories, we can begin the next phase; designing the “look and feel” of our new tool based on the requirements we have been given.  Having a general idea of what our stakeholders are needing reduces our work effort, as well as setting clear expectations that are agreed upon.</p>

<p>Understanding why we need to gather requirements is the first step.  The next post in this series I will discuss how you can use Kanban, digitally and manually, to organize our tasks so that you or your team can keep track of the status/progress along the way.</p>

<p>The final post in this series, we will begin designing our code layout.  This will help us and our stakeholders understand what parameters need to be present, what objects should be accepted in the pipeline, what return objects should look like, and how the new tool will be used.</p>

    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/archive">archive</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://letsautomate.it/article/how-i-work/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://letsautomate.it/article/how-i-work/">How I Work</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2018-08-07</span>
            
        

        

        

        
            <span class="author"><a href="/author/josh-rickard">Josh Rickard</a></span>
        
    </div>

    
        <p>I recently saw this project shared by Adam Bertram, and decided that some of you may be interested in how I work on a day to day.</p>

<p><a href="https://github.com/adbertram/HowIWorkIT/blob/master/README.md">https://github.com/adbertram/HowIWorkIT/blob/master/README.md</a></p>

<p>If you&rsquo;re not interested, well then why the hell are you here?  You can see others that have participated here: <a href="https://github.com/adbertram/HowIWorkIT/blob/master/ThisIsHowIWork.md">https://github.com/adbertram/HowIWorkIT/blob/master/ThisIsHowIWork.md</a></p>

<p>&nbsp;
<h3><strong>Where are you located?</strong></h3>
First of all, my name is Josh Rickard and I&rsquo;m located in Columbia, Missouri.  It sounds lame, but really it&rsquo;s a great little town.  The population of Columbia is around 100,
                000 (without students).  With that being said, we have about 5 College&rsquo;s/Universities, so our population increases quite a bit when students are in town.
<h3><strong>What is/are your current gig(s):</strong></h3>
I currently work at home for PhishMe; if you&rsquo;re not familiar, then check us out: <a href="http://phishme.com/">http://phishme.com/</a>.  My position at PhishMe is currently &ldquo;Manager, Reporter Solutions Engineering&rdquo;.  I&rsquo;m a new manager, but we do anything and everything to do with PhishMe Reporter products (email client plugin/add-in to reporter suspicious messages).  When I say everything, I mean everything from customer engagement, support, troubleshooting, development, etc.</p>

<p><strong>What&rsquo;s one word to describe your work?</strong></p>

<p>Creativity
<h3><strong>What apps, software, or tools can’t you live without?</strong></h3>
Without a doubt, PowerShell.  Besides that, the biggest in each category are:
<ul>
    <li>Apps
<ul>
    <li>Jira</li>
    <li>Confluence</li>
    <li>Slack (and appear.in)</li>
</ul>
</li>
    <li>Software
<ul>
    <li><a href="https://www.sapien.com/software/powershell_studio">PowerShell Studio</a></li>
    <li>Visual Studio Code</li>
    <li>OneNote</li>
    <li>VMWare Fusion</li>
</ul>
</li>
    <li>Tools
<ul>
    <li><a href="http://www.doanepaper.com/">Doane Notebook </a>and a great pen
<ul>
    <li>I know, I may be the only one but I still carry a pen and piece of paper daily.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3><strong>What does your workspace look like? (Take a picture if you can)</strong></h3>
So, since I work at home but workspace can get fairly messy but I try to keep it as clean as possible (even though my wife says I don’t :))</p>

<p><a href="http://msadministrator.com/2016/11/28/how-i-work/img_1350/" rel="attachment wp-att-332"><img class="alignnone size-full wp-image-332" src="https://msadministrator.files.wordpress.com/2016/11/img_1350.jpeg" alt="img_1350" width="519" height="389" /></a> <a href="http://msadministrator.com/2016/11/28/how-i-work/img_1351/" rel="attachment wp-att-333"><img class="alignnone size-full wp-image-333" src="https://msadministrator.files.wordpress.com/2016/11/img_1351.jpeg" alt="img_1351" width="519" height="389" /></a> <a href="http://msadministrator.com/2016/11/28/how-i-work/img_1352/" rel="attachment wp-att-334"><img class="alignnone size-full wp-image-334" src="https://msadministrator.files.wordpress.com/2016/11/img_1352.jpeg" alt="img_1352" width="519" height="389" /></a> <a href="http://msadministrator.com/2016/11/28/how-i-work/img_1353/" rel="attachment wp-att-335"><img class="alignnone size-full wp-image-335" src="https://msadministrator.files.wordpress.com/2016/11/img_1353.jpeg" alt="img_1353" width="519" height="389" /></a>
<h3><strong>What&rsquo;s a typical workweek look like?</strong></h3>
Since PhishMe is based on the east coast, and I live in the Midwest, I typically work in eastern time.  I&rsquo;m a new manager, so my typical workweek contains of lots of project work that ranges from documentation, to building new tools (using PowerShell mostly), automating processes, moving development forward, and making sure that all our customers needs have been met.</p>

<p><strong>What do you like the best about your role?</strong></p>

<p>The best thing about my position is the ability to experiment and come up with new solutions for problems affecting our customers as well as new products.  Besides that, I love my team.  I have 8 guys underneath me and working them has made me excited for the next work week.  We have a highly jelled team, which, as you may know is extremely rare.
<h3><strong>What&rsquo;s something about you that no one knows about?</strong></h3>
Some of you may know this, some of you probably not, but I went to school late in life; I&rsquo;ve only been in IT for 5 <sup>1</sup>&frasl;<sub>2</sub> years.  So you can say I&rsquo;m still learning the IT way. :)
<h3><strong>What do you listen to while you work?</strong></h3>
I LOVE MUSIC!!!!  Like, seriously LOVE IT! But when I work, I don&rsquo;t listen to anything.  I can&rsquo;t.  I&rsquo;m a traditionalist and I love listening to the lyrics of music, but while I&rsquo;m working I get too distracted if I try to listen to music.
<h3><strong>What do you wish you could change about your work?</strong></h3>
Now that I&rsquo;m manager of my team, I find that I can&rsquo;t focus on scripting/coding as much as I used to be able to.  I&rsquo;ve really only been manager for about 3 months, so most of my time right now is focused on process improvement and making sure all our projects are moving forward.
<h3><strong>Is there anything else you’d like to add that might be interesting to readers?</strong></h3>
I decided to list out my career progression and some projects that I&rsquo;ve worked on:
<ul>
    <li>Helpdesk at a small college (9 months)
<ul>
    <li>Managed Accounts</li>
    <li>Ran TONS of network cable</li>
    <li>Implemented wireless across small college campus (College capstone project)</li>
</ul>
</li>
    <li>System Support Analyst - Entry (14 months)
<ul>
    <li>Worked at a larger University/Medical</li>
    <li>Re-organized AD, GPOs, etc for over 3,
                000 users/pcs</li>
    <li>Learned and implemented MDT for all 3,
                000 users/pcs</li>
    <li>GCWN (SANS Certified Windows Security Administrator)</li>
</ul>
</li>
    <li>System Support Analyst - Specialist (5 Months)
<ul>
    <li>Implemented MDT for another division within the University</li>
    <li>Guided a lot of initiatives that are still used today</li>
</ul>
</li>
    <li>Security Analyst - Specialist (24 months)
<ul>
    <li>Hired as part of the Incident Response and Digital Forensics team for the University</li>
    <li>Managed cases/investigations/etc.</li>
    <li>Implemented QualysGuard Vulnerability Management for over 5,
                000 servers</li>
    <li>Implemented/Designed Kaspersky Endpoint Security administrative console for entire campus</li>
    <li>Developed automation &amp; defense tools for protection of University assets.</li>
</ul>
</li>
    <li>Solutions Engineer - PhishMe (9 Months)
<ul>
    <li>Solutions Engineer responsible for advancing development and products</li>
    <li>Responsible for (ongoing) new products and solutions</li>
    <li>Automate EVERYTHING!</li>
</ul>
</li>
    <li>Manager, Reporter Solutions Engineering
<ul>
    <li>Responsible for global support, engagement, development and automation tools to support our global customers with more than 5.5 Million endpoints installed globally.</li>
    <li>8 Employee&rsquo;s</li>
    <li>Product development, enhancements, and bug hunting.</li>
</ul>
</li>
</ul>
Besides all of this, I am responsible for tons of projects which can be found on my GitHub: <a href="https://github.com/MSAdministrator">https://github.com/MSAdministrator</a></p>

    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/archive">archive</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://letsautomate.it/article/powershell-qualys-get-asset-group-info-part-2/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://letsautomate.it/article/powershell-qualys-get-asset-group-info-part-2/">Powershell Qualys Get Asset Group Info Part 2</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2018-08-07</span>
            
        

        

        

        
            <span class="author"><a href="/author/josh-rickard">Josh Rickard</a></span>
        
    </div>

    
        <p>Today I decided to write another post regarding PowerShell and Qualys Vulnerability Management API.  This post will focus on gathering information about your enrolled Asset Groups.   You can find the complete script on GitHub: <a href="https://github.com/MSAdministrator/POSH-Guard/blob/master/Get-QualysAssetGroupInformation" target="_blank"><a href="https://github.com/MSAdministrator/POSH-Guard/blob/master/Get-QualysAssetGroupInformation">https://github.com/MSAdministrator/POSH-Guard/blob/master/Get-QualysAssetGroupInformation</a></a></p>

<p>We start of by opening up PowerShell ISE and using our handy &ldquo;Snippet&rdquo; shortcut:</p>

<p><a href="http://msadministrator.com/2016/02/03/powershell-qualys-get-asset-group-info-part-2/powershell_ise_ctrl__j/" rel="attachment wp-att-318"><img class="alignnone size-full wp-image-318" src="https://msadministrator.files.wordpress.com/2016/02/powershell_ise_ctrl__j.png" alt="PowerShell_ISE_CTRL_+_J" width="519" height="618" /></a></p>

<p>We select the &ldquo;Cmdlet (Advanced function) - complete&rdquo; option in the &ldquo;Snippet&rdquo; context menu.  Once we have our advanced function template, we then proceed by entering a name for our Qualys Asset Group function.</p>

<p>Since we will be gathering some additional information about our Asset Groups, I am going to name my function: [code
                    ]</p>

<p>function Get-QualysAssetGroupInformation</p>

<p>[/code
                    ]</p>

<p>Next, we will start by filling out our &ldquo;Help&rdquo; info.  At this point, a lot of people skip this step; I HIGHLY recommend that you do not.  It will help you and anyone else viewing your code, understand what your intention was when writing this function.</p>

<p>Next, we start by looking at our advanced functions template within the body of this function.  The first thing you will see is some default parameters for [CmdletBinding
                    ].  With my function, I&rsquo;m going to weed these parameters down a bit, as they are not really needed.  Your function should look something like this when complete: [code
                    ]
function Get-QualysAssetGroupInformation
{
                        [CmdletBinding(SupportsShouldProcess=$true,
                  HelpUri = &lsquo;https: //raw.githubusercontent.com/MSAdministrator/POSH-Guard/master/Get-QualysAssetGroupInformation&rsquo;,
                  ConfirmImpact=&lsquo;Medium&rsquo;)
                        ]
    [Alias()
                        ]
    Param
    (
        # Param1 help description
        [parameter(Mandatory=$true,
                   ValueFromPipeline=$true,
                   ValueFromPipelineByPropertyName=$true,
                   HelpMessage=&quot;Please provide a credential obejct&quot;)
                        ]
                   [ValidateNotNullOrEmpty()
                        ]
                   [System.Management.Automation.CredentialAttribute()
                        ]$credential
        )</p>

<pre><code>Begin
{}
Process
{}
End
{}
                }
</code></pre>

<p>[/code
                    ]</p>

<p>After we have the base of this function setup and ready to go, we will start off by adding some code into our Begin block.  Remember, the Begin block will always run once for every call to the function.</p>

<p>[code
                    ]
    $results = @()
    $assetGroupInfo = @()
        [xml
                    ]$assetGroupInfo = Invoke-RestMethod -Uri &quot;https: //qualysapi.qualys.com/msp/asset_group_list.php&quot; -Credential $credential [/code
                    ]</p>

<p>Here I am setting my $assetGroupInfo and a $results variable as empty array&rsquo;s/hash-table&rsquo;s. Next, I&rsquo;m casting my $assetGroupInfo variable as an XML object. This ensures that we receive XML from Invoke-RestMethod Cmdlet.</p>

<p>If we want to make sure that any errors are caught, we should add a Try/Catch block to our Invoke-RestMethod call. Your code should look like this: [code
                    ]
 Begin
    {
        $results = @()
        $assetGroupInfo = @()</p>

<pre><code>    Try
    {
                        [xml
                        ]$assetGroupInfo = Invoke-RestMethod -Uri &amp;quot;https: //qualysapi.qualys.com/msp/asset_group_list.php&amp;quot; -Credential $credential
                    }
    Catch
    {
        Write-Debug &amp;quot;Error using Invoke-RestMethod: $_&amp;quot;
                    }
                }
</code></pre>

<p>[/code
                    ]</p>

<p>Now we move to the Process block. This is where we will be parsing our data into our objects. As I mentioned above, we are wanting to gather all our Asset Groups Titles, their assigned IP Addresses, their role, and the users login ID. To do this, we must loop through each item, or branch returned by our query above. Each $item can be considered as an Asset Group. Additionally, we need to loop through each of the users assigned to that Asset Group.</p>

<p>Once we have that data, we want to create a Custom PSObject to hold all of this data. Your code should look like this: [code
                    ]
Process
{
    foreach ($item in $assetGroupInfo.SelectNodes(&quot;/ASSET_GROUP_LIST/ASSET_GROUP&quot;))
    {
        for ($u=0; $u -lt $($item.ASSIGNED_USERS.ASSIGNED_USER.LOGIN).count;$u++)
        {
            $tempAssetGroupInfo = @()</p>

<pre><code>                            $props = @{
            userlogin=$($item.ASSIGNED_USERS.ASSIGNED_USER[$u
                                ].LOGIN.InnerText)
            userrole=$($item.ASSIGNED_USERS.ASSIGNED_USER[$u
                                ].ROLE.InnerText)
                                       assetgrouptitle=$($item.TITLE.InnerText)
                                       ip=$($item.SCANIPS.IP)
                            }

        $tempAssetGroupInfo = New-Object PSObject -Property $props

                            $results += $tempAssetGroupInfo
                        }
                    }
                }
</code></pre>

<p>[/code
                    ]</p>

<p>Now, we can either simply put the following line in our End block: [code
                    ]
return $results
[/code
                    ]</p>

<p>But, I actually like it to be saved into an XML file. This means that I can use this data with other functions without having to call Qualys again. To be quite frank, as you may know, Qualys is not the fastest website/service out there. Don&rsquo;t get me wrong, the scanning engines are fast, but their database(s) - not so much.</p>

<p>To return both the object and export the results to an XML, we can just add this one line of code: [code
                    ]
Export-Clixml -Path &quot;$env:USERPROFILE\Desktop\QualysData\assetgroupinfo.xml&quot; -InputObject $results
[/code
                    ]</p>

<p>That&rsquo;s it. We now have a function that can return some details about our Asset Groups within Qualys. Next time, I will focus on creating a function that gathers our enrolled IP Addresses, split&rsquo;s them into a single list.</p>

<p>Hint: Qualys loves IP ranges (192.168.0.1-192.168.0.123) and their API calls return it the same way. :)</p>

    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/archive">archive</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://letsautomate.it/article/powershell-qualys-authentication-part-1/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://letsautomate.it/article/powershell-qualys-authentication-part-1/">Powershell Qualys Authentication Part 1</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2018-08-07</span>
            
        

        

        

        
            <span class="author"><a href="/author/josh-rickard">Josh Rickard</a></span>
        
    </div>

    
        I always mean to post more on my blog, but as life gets in the way and work keeps me busy, I always seem to push it to the back-burner. This time, I am hoping to make it stick as a regular routine.
To kick off my new-found motivation to blog more, I am starting a series of posts surrounding PowerShell and Qualys Vulnerability Management API.
To start this off, first I&rsquo;m going to share some my basic steps with regards to authentication to Qualys VM API v1.

        
            <a href="https://letsautomate.it/article/powershell-qualys-authentication-part-1/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/archive">archive</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://letsautomate.it/article/presentation-securing-windows-with-group-policy/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://letsautomate.it/article/presentation-securing-windows-with-group-policy/">Presentation Securing Windows With Group Policy</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2018-08-07</span>
            
        

        

        

        
            <span class="author"><a href="/author/josh-rickard">Josh Rickard</a></span>
        
    </div>

    
        Recently I gave a presentation at MORENet&rsquo;s 2015 Annual Conference about &ldquo;Securing Windows with Group Policy&rdquo;. This presentation was part of their &ldquo;Advanced&rdquo; technology track, and really focused on looking at the current permission levels of your users and deciding if they really need those rights/permissions.
I hope some people find these slides useful or at least a good reference point. If you have any questions about these slides then please do not hesitate to contact me by leaving a comment below.

        
            <a href="https://letsautomate.it/article/presentation-securing-windows-with-group-policy/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/archive">archive</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    

    
    <div class="paginator">
        
            <a href="/author/josh-rickard/page/8/" class="older"><i class="fa fa-angle-double-left"></i> Older posts</a>
        

        
            <a href="/author/josh-rickard/page/6/" class="newer">Newer posts <i class="fa fa-angle-double-right"></i></a>
        
    </div>



        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="https://letsautomate.it/article/vulnerability-management-program-best-practices/">Vulnerability Management Program Best Practices</a>
                    </li>
                
                    <li>
                        <a href="https://letsautomate.it/article/every-security-team-is-a-software-team-now/">Every Security Team Is a Software Team Now</a>
                    </li>
                
                    <li>
                        <a href="https://letsautomate.it/article/microsoft-defender-advanced-threat-detection-queries/">Microsoft Defender Advanced Threat Detection Queries</a>
                    </li>
                
                    <li>
                        <a href="https://letsautomate.it/article/swimlanes-research-teams-open-sources-pyattck/">Swimlane&#39;s Research Teams Open Sources pyattck</a>
                    </li>
                
                    <li>
                        <a href="https://letsautomate.it/article/swimlane-open-sources-graphish-to-help-secops-teams/">Swimlane Open Sources graphish to Help SecOps Teams</a>
                    </li>
                
                    <li>
                        <a href="https://letsautomate.it/article/hey-infosec-what-are-you-doing-to-protect-your-devops-teams/">Hey InfoSec, What Are You Doing to Protect Your DevOps Teams</a>
                    </li>
                
                    <li>
                        <a href="https://letsautomate.it/article/swimlane-research-team-open-sources-py-ews/">Swimlane Research Team Open Sources py-ews</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="/categories/swimlane">Swimlane (13)</a>
                    </li>
                
                    <li>
                        <a href="/categories/powershell">Powershell (7)</a>
                    </li>
                
                    <li>
                        <a href="/categories/azure">Azure (4)</a>
                    </li>
                
                    <li>
                        <a href="/categories/automation">Automation (1)</a>
                    </li>
                
                    <li>
                        <a href="/categories/how-to">How to (1)</a>
                    </li>
                
                    <li>
                        <a href="/categories/python">Python (1)</a>
                    </li>
                
                    <li>
                        <a href="/categories/slack">Slack (1)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/MS_dministrator" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/MSAdministrator" target="_blank"><i class="fa fa-github"></i></a>
                
                
                    <a href="https://www.linkedin.com/in/josh-rickard/" target="_blank"><i class="fa fa-linkedin"></i></a>
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/Lednerb" target="_blank">
                &copy;
                
                    2018
                
                by Lednerb
            </a>
	    -
		<a href="https://letsautomate.it/author/josh-rickard/index.xml">RSS</a>
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        
            <script>
    var client = algoliasearch("NLP9E0F1NO", "a4ffdf988b82857fa86f4403da30ec7f");
    var index = client.initIndex("prod_msadministrator");

    $('#search').autocomplete({ hint: false, autoselect: true, debug: false },
      [
        {
          
            source: $.fn.autocomplete.sources.hits(index, { hitsPerPage: 5, filters: 'language: en' }),
          
          displayKey: function(suggestion) {
            return suggestion.title || suggestion.author
          },
          templates: {
            suggestion: function(suggestion) {
                return "<span class='entry " + suggestion.type + "'>"
                      + "<span class='title'>" + suggestion.title + "</span>"
                      + "<span class='fa fa-fw " + suggestion.iconClass + "'></span>"
                  + "</span>"
                ;
            },
            empty: function() {
              return "<span class='empty'>Nothing found.</span>"
            },
            footer: function() {
              return '<div class="branding">Powered by <img src="https:\/\/letsautomate.it\/dist\/algolia-logo-light.svg" /></div>'
            }

          },
        }
      ])
      .on('autocomplete:selected', function(event, suggestion, dataset) {
        window.location = (suggestion.url);
      })
      .keypress(function (event, suggestion) {
        if (event.which == 13) {
          window.location = (suggestion.url);
        }
      });
</script>

        


    </body>
</html>
