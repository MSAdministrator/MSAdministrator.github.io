<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Josh Rickard">
        <meta name="description" content="Lets Automate It">
        <meta name="keywords" content="blog,powershell,security,pwsh,python,active,directory,grouppolicy,windows,microsoft">
        <meta name="generator" content="Hugo 0.49" />
        <title> Adding a Dlls Certificate to a Trusted Store | Lets Automate It</title>
        <meta name="description" content="Adding a Dlls Certificate to a Trusted Store - Lets Automate It">
        <meta itemprop="name" content="Adding a Dlls Certificate to a Trusted Store">
        <meta itemprop="description" content="Adding a Dlls Certificate to a Trusted Store - Lets Automate It">
        <meta property="og:title" content="Adding a Dlls Certificate to a Trusted Store">
        <meta property="og:description" content="Adding a Dlls Certificate to a Trusted Store - Lets Automate It">
        <meta property="og:image" content="https://letsautomate.it/images/default.jpg">
        <meta property="og:url" content="https://letsautomate.it/article/adding-a-dlls-certificate-to-trusted-store/">
        <meta property="og:site_name" content="Lets Automate It">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://letsautomate.it/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://letsautomate.it/favicon-16x16.png" sizes="16x16">

	

        <link rel="stylesheet" href="https://letsautomate.it/dist/theme.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav>

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="/page/projects/">Projects</a></li>
                
            
                
                    <li><a href="/page/presentations/">Presentations</a></li>
                
            
                
                    <li><a href="/page/about/">About</a></li>
                
            
        </ul>

        
            <div id="search-box" class="search">
                <i class="fa fa-search"></i>
                <input id="search" type="text" placeholder="Search ...">
            </div>
        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="/images/default.jpg" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Lets Automate It</a></h3>
            
                <span class="subtitle">from Josh Rickard</span>
            
        </div>

    

        
        <div class="toggler">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="/article/adding-a-dlls-certificate-to-trusted-store/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="/article/adding-a-dlls-certificate-to-trusted-store/">Adding a Dlls Certificate to a Trusted Store</a></h3>
    <div class="meta">
        <span class="date moment">2018-08-08</span>
        
            <span class="categories">
                
                    <a href="/categories/powershell">powershell</a>
                
            </span>
        
        
            <span class="author"><a href="/author/josh-rickard">Josh Rickard</a></span>
        
         <div class="social-media"></div>
<ul class="share-buttons">
    <li>
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://letsautomate.it%2farticle%2fadding-a-dlls-certificate-to-trusted-store%2f" target="_blank" title="Share on Facebook">
            <i class="fa fa-facebook" aria-hidden="true"></i>
            <span class="sr-only">Share on Facebook</span>
        </a>
    </li>
    
    <li>
        <a href="//twitter.com/share?url=https://letsautomate.it%2farticle%2fadding-a-dlls-certificate-to-trusted-store%2f&amp;text=Adding%20a%20Dlls%20Certificate%20to%20a%20Trusted%20Store&amp;hashtags=%5bcertificate%20cryptography%20.NET%5d&amp;via=Josh%20Rickard" target="_blank" title="Tweet">
            <i class="fa fa-twitter" aria-hidden="true"></i>
            <span class="sr-only">Tweet</span>
        </a>
    </li>
    <li>
        <a href="//www.linkedin.com/shareArticle?url=https://letsautomate.it%2farticle%2fadding-a-dlls-certificate-to-trusted-store%2f&amp;title=Adding%20a%20Dlls%20Certificate%20to%20a%20Trusted%20Store" target="_blank" title="LinkedIn">
            <i class="fa fa-linkedin" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span>
        </a>
    </li>
    <li>
        <a href="http://www.reddit.com/submit?url=https://letsautomate.it%2farticle%2fadding-a-dlls-certificate-to-trusted-store%2f" target="_blank" title="Reddit">
            <i class="fa fa-reddit" aria-hidden="true"></i>
            <span class="sr-only">Reddit</span>
        </a>
    </li>
    <li>
        <a href="mailto:?subject=Check out this post by Josh%20Rickard&amp;body=https://letsautomate.it%2farticle%2fadding-a-dlls-certificate-to-trusted-store%2f" target="_blank" title="Email">
            <i class="fa fa-envelope" aria-hidden="true"></i>
            <span class="sr-only">Email</span>
        </a>
    </li>
</ul>


<style>
    ul.share-buttons {
        list-style: none;
        padding: 0;
    }

    ul.share-buttons li {
        display: inline;
    }

    ul.share-buttons .sr-only {
        position: absolute;
        clip: rect(1px 1px 1px 1px);
        clip: rect(1px, 1px, 1px, 1px);
        padding: 0;
        border: 0;
        height: 1px;
        width: 1px;
        overflow: hidden;
    }
</style>
    </div>

    
        <p>Yesterday I was asked to help with streamling a manual process that some QA folks were running into.  They had a debug release of an applicaiton that was signed with a test code signing certificate.  Part of the process was that they needed to select a DLL, view the certificate, and then install the certificate into the machines trusted certificate store.</p>

<p>This is a extremely simple task, but it was just an annoyance, so I wrote a few lines of code to autoamte this for them.</p>

<pre><code class="language-powershell">$certificate = [System.Security.Cryptography.X509Certificates.X509Certificate]::CreateFromSignedFile('C:\some\path\to\a\file.dll')
$cert2 = [System.Security.Cryptography.X509Certificates.X509Certificate2]::new($certificate)

$certStore = [System.Security.Cryptography.X509Certificates.X509Store]::new([System.Security.Cryptography.X509Certificates.StoreName]::Root, [System.Security.Cryptography.X509Certificates.StoreLocation]::LocalMachine)

$certStore.Open([System.Security.Cryptography.X509Certificates.OpenFlags]::ReadWrite)
$certStore.Add($cert2)
$certStore.Close()
</code></pre>

<p>To break this down further, the first thing that we do is call a the <code>CreateFromSignedFile</code> method.  THis method takes a filepath as a parameter and will create a <code>$certificate</code> object with information stored in the dll.  The next thing is that we now need to take that object and create a new <code>Certificate2</code> from that existing <code>$certificate</code> metadata.</p>

<p>Next, we create a <code>X509Store</code> object by specifying the <code>StoreName</code> we want to store the certiicate in.  Depending on where you want to store this certificate, your value may be different, but for this example we are storing the certificate in our Trusted Root Publishers store.  We also need to pass in if we want to store this in the <code>LocalMachine</code> or <code>User</code> portion of our certificate store.</p>

<p>Lastly, we simply open our certificate store with the <code>ReadWrite</code> permissions. After this, we then simply add our created certificate into the store using the <code>$certStore.Add()</code> method.</p>

<p>Once we are done, we simply close the store and go on our mary little way.</p>

<p>I hope this helps breakdown how to recreate a DLLs signed certificate and store it in local certificate store.</p>

    
     
    <div class="footer">
         
            <div class="tags">
                <i class="fa fa-tags"></i>
                <div class="links">
                    
                    <a href="/%20/tags/%20certificate">certificate</a>
                    
                    <a href="/%20/tags/%20cryptography">cryptography</a>
                    
                    <a href="/%20/tags/%20.net">.NET</a>
                    
                </div>
            </div>
            
</div>

    
</article>
            <p>Yesterday I was asked to help with streamling a manual process that some QA folks were running into.  They had a debug release of an applicaiton that was signed with a test code signing certificate.  Part of the process was that they needed to select a DLL, view the certificate, and then install the certificate into the machines trusted certificate store.</p>

<p>This is a extremely simple task, but it was just an annoyance, so I wrote a few lines of code to autoamte this for them.</p>

<pre><code class="language-powershell">$certificate = [System.Security.Cryptography.X509Certificates.X509Certificate]::CreateFromSignedFile('C:\some\path\to\a\file.dll')
$cert2 = [System.Security.Cryptography.X509Certificates.X509Certificate2]::new($certificate)

$certStore = [System.Security.Cryptography.X509Certificates.X509Store]::new([System.Security.Cryptography.X509Certificates.StoreName]::Root, [System.Security.Cryptography.X509Certificates.StoreLocation]::LocalMachine)

$certStore.Open([System.Security.Cryptography.X509Certificates.OpenFlags]::ReadWrite)
$certStore.Add($cert2)
$certStore.Close()
</code></pre>

<p>To break this down further, the first thing that we do is call a the <code>CreateFromSignedFile</code> method.  THis method takes a filepath as a parameter and will create a <code>$certificate</code> object with information stored in the dll.  The next thing is that we now need to take that object and create a new <code>Certificate2</code> from that existing <code>$certificate</code> metadata.</p>

<p>Next, we create a <code>X509Store</code> object by specifying the <code>StoreName</code> we want to store the certiicate in.  Depending on where you want to store this certificate, your value may be different, but for this example we are storing the certificate in our Trusted Root Publishers store.  We also need to pass in if we want to store this in the <code>LocalMachine</code> or <code>User</code> portion of our certificate store.</p>

<p>Lastly, we simply open our certificate store with the <code>ReadWrite</code> permissions. After this, we then simply add our created certificate into the store using the <code>$certStore.Add()</code> method.</p>

<p>Once we are done, we simply close the store and go on our mary little way.</p>

<p>I hope this helps breakdown how to recreate a DLLs signed certificate and store it in local certificate store.</p>

        
    </div>
    

     

        </div>

        <footer>
    <div class="container">
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="/article/python-vs-powershell-part-1-versioning/">Python vs Powershell Part 1: Versioning</a>
                    </li>
                
                    <li>
                        <a href="/article/using-amazon-sns-with-powershell/">Using Amazon SNS With Powershell</a>
                    </li>
                
                    <li>
                        <a href="/article/how-to-setup-a-hugo-website-on-github/">How to Setup a Hugo Website on GitHub</a>
                    </li>
                
                    <li>
                        <a href="/article/using-amazon-sqs-with-powershell/">Using Amazon Sqs With Powershell</a>
                    </li>
                
                    <li>
                        <a href="/article/traverse-local-certificate-store-with-powershell/">Traverse Local Certificate Store With Powershell</a>
                    </li>
                
                    <li>
                        <a href="/article/powershell-scripts-functions-modules-cmdlets-oh-my/">Powershell Console, Scripts, Functions, Modules, Cmdlets, Oh My!</a>
                    </li>
                
                    <li>
                        <a href="/article/using-github-to-revive-blog-posts/">Using Github to Revive Blog Posts</a>
                    </li>
                
                    <li>
                        <a href="/article/connect-your-bot-to-slack/">Connect Your Bot to Slack</a>
                    </li>
                
                    <li>
                        <a href="/article/create-a-web-app-bot-using-azure-bot-services/">Create a Web App Bot Using Azure Bot Services</a>
                    </li>
                
                    <li>
                        <a href="/article/using-qnamaker-to-create-chatbot/">Using Qnamaker to Create Chatbot</a>
                    </li>
                
                </ul>
        </div>

        <div class="categories">
            <strong>Categories</strong>

            
                <ul>
                
                    <li>
                        <a href="/categories/automation">Automation (1)</a>
                    </li>
                
                    <li>
                        <a href="/categories/azure">Azure (4)</a>
                    </li>
                
                    <li>
                        <a href="/categories/how-to">How to (1)</a>
                    </li>
                
                    <li>
                        <a href="/categories/powershell">Powershell (7)</a>
                    </li>
                
                    <li>
                        <a href="/categories/python">Python (1)</a>
                    </li>
                
                    <li>
                        <a href="/categories/slack">Slack (1)</a>
                    </li>
                
                </ul>
            
        </div>

        <div class="right">
            
            <div class="social-media">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/MS_dministrator" target="_blank"><i class="fa fa-twitter"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/MSAdministrator" target="_blank"><i class="fa fa-github"></i></a>
                
                
                    <a href="https://www.linkedin.com/in/josh-rickard/" target="_blank"><i class="fa fa-linkedin"></i></a>
                
            </div>
            

            
        </div>
    </div>
</footer>

<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/Lednerb" target="_blank">
                &copy;
                
                    2018
                
                by Lednerb
            </a>
	    -
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>

        
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-35980408-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments) };
    gtag('js', new Date());

    gtag('config', 'UA-35980408-2');
</script>


        

        <script src="https://letsautomate.it/dist/theme.js" type="application/javascript"></script>

        
            
        

        <script>
            $(document).ready(function() {
                $(".moment").each(function() {
                    $(this).text(
                        moment( $(this).text() )
                            .locale( "en" )
                            .format('LL')
                    );
                });

                $(".footnote-return sup").html("[return]")
            })
        </script>

        
            <script>
    var client = algoliasearch("NLP9E0F1NO", "a4ffdf988b82857fa86f4403da30ec7f");
    var index = client.initIndex("prod_msadministrator");

    $('#search').autocomplete({ hint: false, autoselect: true, debug: false },
      [
        {
          
            source: $.fn.autocomplete.sources.hits(index, { hitsPerPage: 5, filters: 'language: en' }),
          
          displayKey: function(suggestion) {
            return suggestion.title || suggestion.author
          },
          templates: {
            suggestion: function(suggestion) {
                return "<span class='entry " + suggestion.type + "'>"
                      + "<span class='title'>" + suggestion.title + "</span>"
                      + "<span class='fa fa-fw " + suggestion.iconClass + "'></span>"
                  + "</span>"
                ;
            },
            empty: function() {
              return "<span class='empty'>Nothing found.</span>"
            },
            footer: function() {
              return '<div class="branding">Powered by <img src="https:\/\/letsautomate.it\/dist\/algolia-logo-light.svg" /></div>'
            }

          },
        }
      ])
      .on('autocomplete:selected', function(event, suggestion, dataset) {
        window.location = (suggestion.url);
      })
      .keypress(function (event, suggestion) {
        if (event.which == 13) {
          window.location = (suggestion.url);
        }
      });
</script>

        


    </body>
</html>
